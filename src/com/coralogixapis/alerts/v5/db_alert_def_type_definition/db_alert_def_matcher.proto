
message Matcher {
  oneof matcher_type {
    Const const_value = 1;
    MatcherText text_value = 2;
    MatcherRegex regex_value = 3;
    Field field_value = 4;
    MetadataField metadata_field_value = 5;
    Bool bool_value = 6;
  }
}

message Const {
  bool value = 1;
}

message MatcherText {
  string text = 1;
  string tokenized_text = 2;
  repeated string tokenized_set = 3;
}

message MatcherRegex {
  string regex = 1;
}

message Field {
  string field_name = 1;
  FieldValue value = 2;
}

message MetadataField {
  MetadataFieldName field_name = 1;
  FieldValue value = 2;
}

message Bool {
  repeated Matcher must = 1;
  repeated Matcher should = 2;
  repeated Matcher must_not = 3;
}

message FieldValue {
  oneof value_type {
    FieldText text = 1;
    bool exists = 2;
    bool empty = 3;
    Range range = 4;
    DateRange date_range = 5;
    Cidr cidr = 6;
    FieldRegex regex = 7;
  }
}

message FieldText {
  string text = 1;
  string tokenized_text = 2;
  repeated string tokenized_set = 3;
}

message Range {
  google.protobuf.DoubleValue upper = 1;
  google.protobuf.DoubleValue lower = 2;
  bool include_upper = 3;
  bool include_lower = 4;
}

message DateRange {
  google.protobuf.Timestamp upper = 1;
  google.protobuf.Timestamp lower = 2;
  bool include_upper = 3;
  bool include_lower = 4;
}

message Cidr {
  string subnet = 1;
}

message FieldRegex {
  string regex = 1;
}